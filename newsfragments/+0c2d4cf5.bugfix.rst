Refreshed with implementation from CPython 3.13.0rc1.